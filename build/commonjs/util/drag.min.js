/**
 * Hilo 1.0.4 for commonjs
 * Copyright 2016 alibaba.com
 * Licensed under the MIT License
 */
var Hilo=require("../core/Hilo"),drag={startDrag:function(e){function t(e){e.stopPropagation(),r(e),v.off(Hilo.event.POINTER_START,t),v.fire("dragStart",f);var a=v.parent.getConcatenatedMatrix();_.x=v.x,_.y=v.y,a.transformPoint(_),v.__dragX=_.x-f.x,v.__dragY=_.y-f.y,i||(i=this.getStage()),i.on(Hilo.event.POINTER_MOVE,o),document.addEventListener(Hilo.event.POINTER_END,n)}function n(e){document.removeEventListener(Hilo.event.POINTER_END,n),i&&i.off(Hilo.event.POINTER_MOVE,o),v.fire("dragEnd",f),v.on(Hilo.event.POINTER_START,t)}function o(e){r(e),v.fire("dragMove",f),_.x=f.x+v.__dragX,_.y=f.y+v.__dragY;var t=v.parent.getConcatenatedMatrix().invert();t.transformPoint(_),v.x=Math.max(E,Math.min(d,_.x)),v.y=Math.max(g,Math.min(T,_.y))}function r(e){f.preX=f.x,f.preY=f.y,f.x=e.stageX,f.y=e.stageY}function a(){document.removeEventListener(Hilo.event.POINTER_END,n),i&&i.off(Hilo.event.POINTER_MOVE,o),v.off(Hilo.event.POINTER_START,t)}var i,v=this;e=e||[-(1/0),-(1/0),1/0,1/0];var f={x:0,y:0,preX:0,preY:0},E=e[0],g=e[1],d=e[2]==1/0?1/0:E+e[2],T=e[3]==1/0?1/0:g+e[3],_={x:0,y:0};v.on(Hilo.event.POINTER_START,t),v.stopDrag=a},stopDrag:function(){}};module.exports=drag;